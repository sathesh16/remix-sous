{
  "version": 3,
  "sources": ["empty-module:../../sessions.server.js", "../../../app/routes/login/index.jsx"],
  "sourcesContent": ["module.exports = {};", "import { json, redirect } from \"@remix-run/node\";\nimport { Form, useActionData, useTransition, useLoaderData } from \"@remix-run/react\";\nimport { useEffect, useState } from \"react\";\nimport { getSession, commitSession } from \"../../sessions.server.js\";\n\n// \uD83E\uDDE0 Loader \u2014 kick out logged-in users\nexport async function loader({ request }) {\n    const session = await getSession(request);\n    const user = session.get(\"user\");\n    if (user) return redirect(\"/dashboard\");\n    return null;\n}\n\n// \uD83D\uDD39 Function to hit your external login API\nasync function loginToExternalApi({ email, password }) {\n    const response = await fetch(\"http://192.168.1.51:8056/auth/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, password }),\n    });\n\n    if (!response.ok) {\n        const err = await response.text();\n        throw new Error(`Login failed: ${err}`);\n    }\n\n    return await response.json();\n}\n\n// \uD83D\uDD39 Remix action for login\nexport async function action({ request }) {\n    const formData = await request.formData();\n    const email = formData.get(\"email\");\n    const password = formData.get(\"password\");\n\n    if (!email || !password) {\n        return json({ error: \"Email and password required\" }, { status: 400 });\n    }\n\n    try {\n        const result = await loginToExternalApi({ email, password });\n\n        // Create and save session\n        const session = await getSession(request);\n        session.set(\"user\", result.user || { email });\n\n        return redirect(\"/dashboard?login=success\", {\n            headers: {\n                \"Set-Cookie\": await commitSession(session),\n            },\n        });\n    } catch (error) {\n        console.error(\"\u274C Login error:\", error);\n        return json({ error: \"Invalid email or password\" }, { status: 401 });\n    }\n}\n\nexport default function LoginPage() {\n    const actionData = useActionData();\n    const transition = useTransition();\n    const [toast, setToast] = useState(null);\n\n    // Show error toast\n    useEffect(() => {\n        if (actionData?.error) {\n            setToast({ type: \"error\", message: actionData.error });\n            setTimeout(() => setToast(null), 3000);\n        }\n    }, [actionData]);\n\n    return (\n        <div className=\"flex flex-col items-center justify-center min-h-screen gap-4 relative\">\n            {toast && (\n                <div\n                    className={`fixed top-4 right-4 px-4 py-2 rounded shadow-lg text-white ${toast.type === \"error\" ? \"bg-red-600\" : \"bg-green-600\"\n                        }`}\n                >\n                    {toast.message}\n                </div>\n            )}\n            \n\n            <div className=\"flex items-center justify-between\">\n                Login\n                <img src=\"/images/iss_logo.webp\" width=\"50px\"/>\n            </div>\n\n            <Form method=\"post\" className=\"flex flex-col gap-2 w-64\">\n                <input\n                    name=\"email\"\n                    type=\"email\"\n                    placeholder=\"Email\"\n                    required\n                    className=\"border p-2 rounded\"\n                />\n                <input\n                    name=\"password\"\n                    type=\"password\"\n                    placeholder=\"Password\"\n                    required\n                    className=\"border p-2 rounded\"\n                />\n                <button\n                    type=\"submit\"\n                    className=\"bg-blue-600 text-white py-2 rounded\"\n                    disabled={transition.state === \"submitting\"}\n                >\n                    {transition.state === \"submitting\" ? \"Logging in...\" : \"Login\"}\n                </button>\n            </Form>\n        </div>\n    );\n}\n"],
  "mappings": ";;;;;;;;;;;AAAA;AAAA;AAAA,WAAO,UAAU,CAAC;AAAA;AAAA;;;ACElB,IAAAA,gBAAoC;AACpC,6BAA0C;AAsE1B;AAhBD,SAAR,YAA6B;AAChC,QAAM,aAAa,cAAc;AACjC,QAAM,aAAa,cAAc;AACjC,QAAM,CAAC,OAAO,QAAQ,QAAI,wBAAS,IAAI;AAGvC,+BAAU,MAAM;AACZ,QAAI,YAAY,OAAO;AACnB,eAAS,EAAE,MAAM,SAAS,SAAS,WAAW,MAAM,CAAC;AACrD,iBAAW,MAAM,SAAS,IAAI,GAAG,GAAI;AAAA,IACzC;AAAA,EACJ,GAAG,CAAC,UAAU,CAAC;AAEf,SACI,mDAAC,SAAI,WAAU,yEACV;AAAA,aACG;AAAA,MAAC;AAAA;AAAA,QACG,WAAW,8DAA8D,MAAM,SAAS,UAAU,eAAe;AAAA,QAGhH,gBAAM;AAAA;AAAA,MAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAKA;AAAA,IAIJ,mDAAC,SAAI,WAAU,qCAAoC;AAAA;AAAA,MAE/C,mDAAC,SAAI,KAAI,yBAAwB,OAAM,UAAvC;AAAA;AAAA;AAAA;AAAA,aAA6C;AAAA,SAFjD;AAAA;AAAA;AAAA;AAAA,WAGA;AAAA,IAEA,mDAAC,QAAK,QAAO,QAAO,WAAU,4BAC1B;AAAA;AAAA,QAAC;AAAA;AAAA,UACG,MAAK;AAAA,UACL,MAAK;AAAA,UACL,aAAY;AAAA,UACZ,UAAQ;AAAA,UACR,WAAU;AAAA;AAAA,QALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAMA;AAAA,MACA;AAAA,QAAC;AAAA;AAAA,UACG,MAAK;AAAA,UACL,MAAK;AAAA,UACL,aAAY;AAAA,UACZ,UAAQ;AAAA,UACR,WAAU;AAAA;AAAA,QALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAMA;AAAA,MACA;AAAA,QAAC;AAAA;AAAA,UACG,MAAK;AAAA,UACL,WAAU;AAAA,UACV,UAAU,WAAW,UAAU;AAAA,UAE9B,qBAAW,UAAU,eAAe,kBAAkB;AAAA;AAAA,QAL3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAMA;AAAA,SArBJ;AAAA;AAAA;AAAA;AAAA,WAsBA;AAAA,OAtCJ;AAAA;AAAA;AAAA;AAAA,SAuCA;AAER;",
  "names": ["import_react"]
}
