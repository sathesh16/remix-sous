{
  "version": 3,
  "sources": ["empty-module:../../sessions.server", "empty-module:../../auth.server", "../../../app/routes/login/index.jsx"],
  "sourcesContent": ["module.exports = {};", "module.exports = {};", "// app/routes/login.jsx\n// import { Form, useActionData, useNavigation } from \"@remix-run/react\";\nimport { redirect, json } from \"@remix-run/node\";\n// import { loginToExternalApi } from \"~/utils/auth.server\";\n// import { getSession, commitSession } from \"~/sessions.server\";\nimport { useEffect } from \"react\";\n// import toast from \"react-hot-toast\"; // optional if using react-hot-toast\nimport { commitSession, getSession } from \"../../sessions.server\";\nimport { loginToExternalApi } from \"../../auth.server\";\n\nexport async function action({ request }) {\n    const formData = await request.formData();\n    const email = formData.get(\"email\");\n    const password = formData.get(\"password\");\n\n    if (!email || !password) {\n        return json({ error: \"Email and password required\" }, { status: 400 });\n    }\n\n    try {\n        // call external auth endpoint (server-side)\n        const result = await loginToExternalApi({ email, password });\n\n        // result might include user object and token depending on your API\n        // e.g. { user: {...}, token: \"...\" } or raw user object\n        // adapt the following to match your API response shape\n        const user = result.user ?? result;\n\n        if (!user || !user.id) {\n            return json({ error: \"Invalid login response from auth server\" }, { status: 500 });\n        }\n\n        // create session and save minimal user info\n        const session = await getSession(request);\n        session.set(\"user\", {\n            id: user.id,\n            email: user.email,\n            name: user.first_name || user.name || null,\n            // avoid storing sensitive fields like password/token unless necessary\n        });\n\n        return redirect(\"/dashboard\", {\n            headers: {\n                \"Set-Cookie\": await commitSession(session),\n            },\n        });\n    } catch (err) {\n        console.error(\"Login error:\", err);\n        const message = err?.message || \"Login failed\";\n        const status = err?.status || 500;\n        return json({ error: message }, { status });\n    }\n}\n\nexport default function LoginPage() {\n    const actionData = useActionData();\n    const navigation = useNavigation();\n\n    useEffect(() => {\n        if (actionData?.error) {\n            // if using react-hot-toast:\n            // toast.error(actionData.error);\n            // or quick DOM toast as earlier\n            alert(actionData.error); // simple fallback\n        }\n    }, [actionData]);\n\n    return (\n        <div>\n            <h2>Login</h2>\n            <Form method=\"post\">\n                <input name=\"email\" type=\"email\" placeholder=\"Email\" required />\n                <input name=\"password\" type=\"password\" placeholder=\"Password\" required />\n                <button type=\"submit\" disabled={navigation.state === \"submitting\"}>\n                    {navigation.state === \"submitting\" ? \"Logging in...\" : \"Login\"}\n                </button>\n            </Form>\n        </div>\n    );\n}\n"],
  "mappings": ";;;;;;;;AAAA;AAAA;AAAA,WAAO,UAAU,CAAC;AAAA;AAAA;;;ACAlB;AAAA;AAAA,WAAO,UAAU,CAAC;AAAA;AAAA;;;ACKlB,mBAA0B;AAE1B,sBAA0C;AAC1C,kBAAmC;AA6DvB;AAfG,SAAR,YAA6B;AAChC,QAAM,aAAa,cAAc;AACjC,QAAM,aAAa,cAAc;AAEjC,8BAAU,MAAM;AACZ,QAAI,YAAY,OAAO;AAInB,YAAM,WAAW,KAAK;AAAA,IAC1B;AAAA,EACJ,GAAG,CAAC,UAAU,CAAC;AAEf,SACI,mDAAC,SACG;AAAA,uDAAC,QAAG,qBAAJ;AAAA;AAAA;AAAA;AAAA,WAAS;AAAA,IACT,mDAAC,QAAK,QAAO,QACT;AAAA,yDAAC,WAAM,MAAK,SAAQ,MAAK,SAAQ,aAAY,SAAQ,UAAQ,QAA7D;AAAA;AAAA;AAAA;AAAA,aAA8D;AAAA,MAC9D,mDAAC,WAAM,MAAK,YAAW,MAAK,YAAW,aAAY,YAAW,UAAQ,QAAtE;AAAA;AAAA;AAAA;AAAA,aAAuE;AAAA,MACvE,mDAAC,YAAO,MAAK,UAAS,UAAU,WAAW,UAAU,cAChD,qBAAW,UAAU,eAAe,kBAAkB,WAD3D;AAAA;AAAA;AAAA;AAAA,aAEA;AAAA,SALJ;AAAA;AAAA;AAAA;AAAA,WAMA;AAAA,OARJ;AAAA;AAAA;AAAA;AAAA,SASA;AAER;",
  "names": []
}
