{
  "version": 3,
  "sources": ["../../../app/routes/login/index.jsx"],
  "sourcesContent": ["import { json, redirect } from \"@remix-run/node\";\nimport { Form, useActionData, useTransition } from \"@remix-run/react\";\n\nexport async function action({ request }) {\n  const formData = await request.formData();\n  const email = formData.get(\"email\");\n  const password = formData.get(\"password\");\n\n  try {\n    // Step 1: Login request \u2014 allow cookies to persist\n    const loginResponse = await fetch(\"http://192.168.1.51:8056/auth/login\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ email, password }),\n      credentials: \"include\", // \uD83D\uDC48 Important: sends/receives cookies\n    });\n\n    const loginData = await loginResponse.json();\n\n    if (!loginResponse.ok) {\n      return json({ error: loginData.message || \"Login failed\" }, { status: loginResponse.status });\n    }\n\n    // Step 2: Verify login worked by fetching /users/me\n    const meResponse = await fetch(\"http://192.168.1.51:8056/users/me\", {\n      method: \"GET\",\n      credentials: \"include\", // \uD83D\uDC48 include cookie from login\n    });\n\n    const userInfo = await meResponse.json();\n\n    if (!meResponse.ok) {\n      return json({ error: \"Failed to fetch user info\", details: userInfo }, { status: meResponse.status });\n    }\n\n    console.log(\"\u2705 Logged in user:\", userInfo);\n\n    // Step 3: Redirect to dashboard\n    return redirect(\"/dashboard\");\n\n  } catch (error) {\n    console.error(\"\u274C Login process error:\", error);\n    return json({ error: \"Internal Server Error\" }, { status: 500 });\n  }\n}\n\nexport default function LoginPage() {\n  const actionData = useActionData();\n  const transition = useTransition();\n  const isSubmitting = transition.state === \"submitting\";\n\n  return (\n    <div style={{ padding: \"2rem\" }}>\n      <h2>Login</h2>\n      <Form method=\"post\">\n        <input type=\"email\" name=\"email\" placeholder=\"Email\" required />\n        <input type=\"password\" name=\"password\" placeholder=\"Password\" required />\n        <button type=\"submit\" disabled={isSubmitting}>\n          {isSubmitting ? \"Logging in...\" : \"Login\"}\n        </button>\n      </Form>\n\n      {actionData?.error && (\n        <p style={{ color: \"red\", marginTop: \"1rem\" }}>{actionData.error}</p>\n      )}\n    </div>\n  );\n}\n"],
  "mappings": ";;;;;;;;;;;AAqDM;AAPS,SAAR,YAA6B;AAClC,QAAM,aAAa,cAAc;AACjC,QAAM,aAAa,cAAc;AACjC,QAAM,eAAe,WAAW,UAAU;AAE1C,SACE,mDAAC,SAAI,OAAO,EAAE,SAAS,OAAO,GAC5B;AAAA,uDAAC,QAAG,qBAAJ;AAAA;AAAA;AAAA;AAAA,WAAS;AAAA,IACT,mDAAC,QAAK,QAAO,QACX;AAAA,yDAAC,WAAM,MAAK,SAAQ,MAAK,SAAQ,aAAY,SAAQ,UAAQ,QAA7D;AAAA;AAAA;AAAA;AAAA,aAA8D;AAAA,MAC9D,mDAAC,WAAM,MAAK,YAAW,MAAK,YAAW,aAAY,YAAW,UAAQ,QAAtE;AAAA;AAAA;AAAA;AAAA,aAAuE;AAAA,MACvE,mDAAC,YAAO,MAAK,UAAS,UAAU,cAC7B,yBAAe,kBAAkB,WADpC;AAAA;AAAA;AAAA;AAAA,aAEA;AAAA,SALF;AAAA;AAAA;AAAA;AAAA,WAMA;AAAA,IAEC,YAAY,SACX,mDAAC,OAAE,OAAO,EAAE,OAAO,OAAO,WAAW,OAAO,GAAI,qBAAW,SAA3D;AAAA;AAAA;AAAA;AAAA,WAAiE;AAAA,OAXrE;AAAA;AAAA;AAAA;AAAA,SAaA;AAEJ;",
  "names": []
}
