{
  "version": 3,
  "sources": ["../../../app/routes/forgetPassword.jsx"],
  "sourcesContent": ["import React from 'react';\nimport { Form, Link } from '@remix-run/react';\nimport HeaderFile from '~/components/HeaderFile';\nimport Footer from \"~/components/Footer\";\nimport { toast } from 'react-toastify';\nimport { FRONTEND_URL, directusLoaderLink, RESET_BASE_URL,MAIL_SENDER } from '~/utils/constants.js';\n\nexport function meta() {\n    return { title: \"Reset Password\" };\n}\n\nexport default function ForgetPassword() {\n    const [emaildata, setEmaildata] = React.useState('');\n    const [alertshow, setAlertshow] = React.useState(false);\n    const [preventDouble,setPreventDouble]=React.useState(false)\n\n    const directus = directusLoaderLink;\n\n    const forgetHandle = async () => {\n        setPreventDouble(true);\n        await directus.users.readByQuery({\n            fields: [\"*\"],\n            filter: { email: { _eq: emaildata } }\n        }).then(async e => e?.data[0]?.id ? await updateHandle(e?.data[0]?.id) : toast.error('No data found',{\n            onClose:()=>setPreventDouble(false)\n        })\n        );\n    }\n\n    async function postData({ url, token, name, emailTo }) {\n        var msg = {\n            to: emailTo,\n            from: MAIL_SENDER,\n            subject: 'Generated new password',\n            name: name,\n            html: `<div>\n            <p>Hi<strong> ${name}</strong>,</p>\n            <p>Your new password is <strong> ${token}</strong>.</p>\n            <p>Click here to  <a href=${FRONTEND_URL}>login </a></p>\n            \n            <div>`\n        };\n        await fetch(url, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-cache',\n            credentials: 'same-origin',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            redirect: 'follow',\n            referrerPolicy: 'no-referrer',\n            body: JSON.stringify(msg)\n        }).then(e => toast.success('we sent you a secure password to your mail',{\n            onClose:()=>setPreventDouble(false)\n        })\n        ).catch(e => toast.error('Try again some other time',{\n            onClose:()=>setPreventDouble(false)\n        }));\n        return \"\";\n    }\n\n    const updateHandle = async (prop) => {\n        const randomValue = Math.random().toString(36).slice(2, 7)\n        await directus.users.updateOne(prop, {\n            'password': randomValue,\n            'password_token': randomValue,\n            'password_copy':randomValue,\n        }).then(\n            async (res) => {\n                setAlertshow(true);\n                // setPreventDouble(false);\n                await postData({ url: RESET_BASE_URL, token: res?.password_token, name: res?.first_name, emailTo: res?.email })\n                return res\n            }\n        ).catch((err) => {\n            console.log(err)\n            toast.error('Something went wrong',{\n                onClose:()=>setPreventDouble(false)\n            });\n        });\n    }\n\n    return (\n        <>\n            <HeaderFile login />\n            <div className=\"main-content-area\">\n                <div className=\"flex justify-center h-[calc(100vh-75px)] w-full items-center px-5\">\n                    <Form className=\"max-w-[400px] w-full flex flex-col items-center text-[14px] \"\n                        onSubmit={(e) => forgetHandle(e)}\n                    >\n                        <h1 className=\"text-center text-[24px] font-bold text-black mb-16\">\n                            RESET PASSWORD\n                        </h1>\n                        <div className=\"mb-6 w-full\">\n                            <label\n                                htmlFor=\"u-mail-id1\"\n                                className=\"block text-sm font-bold text-gray-700\"\n                            >\n                                Email\n                            </label>\n                            <input\n                                type=\"email\"\n                                id=\"u-mail-id1\"\n                                placeholder=\"Your@email.dk\"\n                                value={emaildata}\n                                onChange={(e) => setEmaildata(e.target.value)}\n                                required\n                                className=\"mt-2 w-full px-4 py-3 flex justify-center items-center shadow-sm border border-primary focus:border-primary placeholder:font-bold placeholder:text-[#6E7878] placeholder:text-[14px] focus:outline-none focus:ring-1 focus:ring-gray-600 sm:text-sm\"\n                            />\n                        </div>\n                        {\n                            alertshow ? <div className='mb-8  border-l-lime-500 ... bg-green-100 px-3 py-3 rounded-md'>\n                                If you have an account, we've sent you a secure link to reset your password\n                            </div> : null\n                        }\n\n                        <div className=\"inline-flex w-full flex-row justify-between\">\n                            <div className=\"\">\n                                <button\n                                    type=\"submit\"\n                                    disabled={preventDouble}\n                                    className=\"inline-flex  items-center justify-center h-[50px] text-[18px] rounded border bg-primary border-primary px-4 py-2 text-sm font-bold text-white shadow-sm hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2\"\n                                >\n                                    Reset\n                                </button>\n                            </div>\n                            <div className=' self-center'>\n                                <Link to={'/login'}>Sign In</Link>\n                            </div>\n                        </div>\n                    </Form>\n                </div>\n            </div>\n            <Footer login/>\n        </>\n    )\n}"],
  "mappings": "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",
  "names": ["React"]
}
