import{a as Me,b as be,c as Ne}from"/build/_shared/chunk-DAAR2UBC.js";import{a as xe}from"/build/_shared/chunk-MZ7CGHKM.js";import{a as ge}from"/build/_shared/chunk-YAUMQ47I.js";import{a as we}from"/build/_shared/chunk-OV4W7B6E.js";import{a as Se}from"/build/_shared/chunk-QPJOCY54.js";import{b as he}from"/build/_shared/chunk-USL65MEA.js";import{d as ye}from"/build/_shared/chunk-RGLHNRFR.js";import"/build/_shared/chunk-7R5B3IJR.js";import"/build/_shared/chunk-VQXNYB6I.js";import{b as p}from"/build/_shared/chunk-YCQR2KKZ.js";import{B as pe,c as fe,h as W}from"/build/_shared/chunk-74WNBD7U.js";import{a as ve}from"/build/_shared/chunk-WA2IKA3N.js";import{a as g,b as O,d as G,g as w,i as I,l as X}from"/build/_shared/chunk-SDPGU3B7.js";import{a as _e}from"/build/_shared/chunk-46CN3765.js";import{j as ue}from"/build/_shared/chunk-62BE6IG2.js";import{a as ie,b as z}from"/build/_shared/chunk-TYFUAS6F.js";import{d as b}from"/build/_shared/chunk-W6WK5VNR.js";var N=b(ie());var ke=b(Me());var De=b(Se());var Oe=b(_e()),H=b(ie());var y=b(ie());var r=b(z());function Le({date:m,locationId:t,roomDetail:ne,showPlaceHolder:$,content:s,setRefresh:S,refresh:P,popupView:C,isAdmin:T}){let Z=xe(),d="yyyy-MM-dd",[u,E]=y.default.useState(s!=null&&s.room_id?s==null?void 0:s.room_id:""),[l,R]=y.default.useState(s!=null&&s.company_name?s==null?void 0:s.company_name:""),[Y,j]=(0,y.useState)(!1),[A,M]=(0,y.useState)(!1),[U,k]=(0,y.useState)(!1),[B,L]=(0,y.useState)(!1),F=(0,y.useRef)(null),ee=f=>{k(!1),R(s!=null&&s.company_name?s==null?void 0:s.company_name:""),E(s!=null&&s.room_id?s==null?void 0:s.room_id:"")};(0,y.useEffect)(()=>{let f=c=>{F.current&&!F.current.contains(c.target)&&(k(!1),R(s!=null&&s.company_name?s==null?void 0:s.company_name:""),E(s!=null&&s.room_id?s==null?void 0:s.room_id:""))};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[]);let se=async()=>{k(!U)},te=async f=>{var q,J;let c=W;L(!0),((q=l==null?void 0:l.trim())==null?void 0:q.length)>0?u?(s!=null&&s.id?await c.items("conference").updateOne(s==null?void 0:s.id,{date:w(m,d),company_name:l,room_id:u==null?void 0:u.id,location_id:t}).then(x=>{p.success("Updated successfully"),k(!1),location.reload(),S(!P)}).catch(x=>{console.log(x),p.error(x)}):await c.items("conference").createOne({date:w(m,d),company_name:l,room_id:u==null?void 0:u.id,location_id:t}).then(x=>{p.success(" Created successfully"),k(!1),S(!P)}).catch(x=>{console.log(x),p.error(x)}),localStorage.setItem("ConferenceWacthedWeek",((J=new Date(m))==null?void 0:J.getDay())==0?w(g(new Date(m),-2),"yyyy-MM-dd"):m)):p.error("Rooms name is required"):p.error("Company name is required"),L(!1)},ae=()=>{let f=c=>(E(c),"");return(0,r.jsx)("div",{children:Z?(0,r.jsx)(we._default,{id:"rooms",instanceId:"roomId",classNamePrefix:"cursor-pointer react-select",className:"react-select-container font-normal text-sm w-full",maxMenuHeight:250,onChange:c=>f(c),isSearchable:!1,components:{IndicatorSeparator:()=>null},value:u,options:ne,getOptionLabel:c=>c.name,getOptionValue:c=>c,styles:{control:c=>({...c,border:"none",boxShadow:"none"})}}):null})},re=async()=>{s!=null&&s.id&&(M(!0),await W.items("conference").deleteOne(s==null?void 0:s.id).then(f=>{p.success("Data deleted successfully")}).catch(f=>{console.log(f)}),S(!P),M(!1),location.reload())},oe=()=>{j(!1)};return y.default.useEffect(()=>{(l==null?void 0:l.length)>100&&R(l==null?void 0:l.substring(0,100))},[l]),(0,r.jsxs)("div",{className:`relative ${C?"c-popup-child":""}`,children:[(0,r.jsx)("div",{className:`tasksname font-futura p-2 text-left font-bold ${$?"no-data":""}`,onClick:se,children:$?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("span",{className:"flex",children:[(0,r.jsx)("i",{className:"ri-add-fill color-primary mr-2"}),"Add company"]})}):(0,r.jsx)(r.Fragment,{children:s==null?void 0:s.company_name})}),U&&(0,r.jsx)("div",{className:"div-block",ref:F,children:(0,r.jsxs)("div",{className:"addcompany flex flex-col p-4 font-normal absolute min-w-[300px] min-h-[300px] bg-[#E7ECE6] border-1 z-10 gap-3 text-sm rounded-[7px]",children:[(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{className:"close-act",onClick:ee,children:(0,r.jsx)("i",{className:"ri-close-line text-primary"})})}),(0,r.jsxs)("div",{className:"col-span-6 mb-3",children:[(0,r.jsx)("label",{htmlFor:"room-name",className:"block text-sm font-medium text-gray-700 uppercase",children:"Company"}),(0,r.jsxs)("div",{className:"relative conference-name",children:[(0,r.jsx)("textarea",{type:"text",name:"company-name",id:"company-name",placeholder:"Company Name",required:!0,value:l,onChange:f=>R(f.target.value),autoComplete:"given-name",className:"resize-none  min-h-[80px] mt-1 block w-full rounded-[3px] border border-gray-300 py-2 px-3 shadow-sm placeholder:text-gray-400 placeholder:!text-sm placeholder:font-medium focus:border-primary  focus:outline-none focus:ring-primary sm:text-sm"}),(0,r.jsxs)("span",{className:"text-[10px] absolute bottom-0 right-2",children:[l==null?void 0:l.length,"/100"]})]})]})," ",(0,r.jsxs)("div",{className:"col-span-6 mb-3",children:[(0,r.jsx)("label",{htmlFor:"room-name",className:"block text-sm font-medium text-gray-700 uppercase",children:"ROOM"}),ae(!1)]}),(0,r.jsxs)("div",{className:`flex pt-6 ${(s==null?void 0:s.id)&&T?"justify-between":"justify-end"}`,children:[(s==null?void 0:s.id)&&T&&(0,r.jsx)("button",{className:"py-1 px-2 border text-white border-red-700 bg-red-700 font-medium rounded-[5px] uppercase min-w-[100px] text-[12px]",onClick:()=>j(!0),title:"delete",children:(0,r.jsx)("i",{className:"ri-delete-bin-line"})}),(0,r.jsx)("button",{className:"py-1 px-2 border text-white border-primary bg-primary font-medium rounded-[5px] uppercase min-w-[100px] text-[12px]",onClick:()=>te(),disabled:B,title:"save",children:B?"Saving...":"Save"})]})]})}),Y&&(0,r.jsx)(be,{modalIsOpen:Y,setIsOpen:j,content:"Are you sure to delete data?",callFunction:re,cancelHandle:oe,Loader:A})]})}var le=Le;var e=b(z());function Ie(){return{title:"Conference Dashboard"}}function Ce(){var J,x,de,ce;let m=ue(),[t,ne]=H.default.useState(m),[$,s]=H.default.useState(m==null?void 0:m.RoomDetails),[S,P]=H.default.useState(m==null?void 0:m.conferenceDetails),C=t==null?void 0:t.locationId,T="yyyy-MM-dd",Z=W,[d,u]=(0,N.useState)(new Date),[E,l]=(0,N.useState)(I(d)),[R,Y]=(0,N.useState)(new Date),[j,A]=(0,N.useState)(!1),[M,U]=(0,N.useState)(!0);(0,N.useEffect)(()=>{var i,D,v,Q,K,V;let a=localStorage.getItem("ConferenceWacthedWeek");if(localStorage.getItem("isUserExist")||(p.success("You are successfully logged in"),localStorage.setItem("isUserExist",!0)),a)try{u(new Date(a)),l(I(new Date(a))),Y(new Date(a)),L({date:new Date(a)}),localStorage.removeItem("ConferenceWacthedWeek")}catch(h){console.log(h)}let n=((i=t==null?void 0:t.currentUser)==null?void 0:i.selected_locations)!==null?(D=t==null?void 0:t.currentUser)==null?void 0:D.selected_locations:(v=t==null?void 0:t.currentUser)==null?void 0:v.allowed_locations[0].Locations_id;localStorage.setItem("admin",(Q=t==null?void 0:t.currentUser)==null?void 0:Q.is_admin),localStorage.setItem("conference",(K=t==null?void 0:t.currentUser)==null?void 0:K.conference),localStorage.setItem("selectedLocation",JSON.stringify(n)),localStorage.setItem("showDietary",JSON.stringify((V=t==null?void 0:t.currentUser)==null?void 0:V.show_dietary))},[M]);let k=(0,N.useRef)(),B=()=>{A(!0),setTimeout(()=>{A(!1)},2500)},L=async a=>{let o=w(O(a==null?void 0:a.date,{weekStartsOn:1}),T),n=w(O(g(a==null?void 0:a.date,7),{weekStartsOn:0}),T);await Z.items("conference").readByQuery({fields:["*.*.*"],filter:{date:{_between:[o,n]},location_id:{_eq:C}},sort:["id"]}).then(i=>{P(i==null?void 0:i.data)}).catch(i=>console.log(i))},F=async a=>{B(),a==="prev"&&(await L({date:X(d,1)}),u(X(d,1)),l(I(X(d,1)))),a==="next"&&(await L({date:G(d,1)}),u(G(d,1)),l(I(G(d,1))))},ee=()=>{let a="EEEE",o=[],n=O(d,{weekStartsOn:1});for(let i=0;i<7;i++)o.push((0,e.jsx)("div",{className:`col col-center  ${i!==6?"border-r":null} bordersky  border-[#C2C2C2] border-collapse p-2 min-w-[110px] table-head`,children:(0,e.jsxs)("div",{className:"col col-center text-sm font-bold text-black",children:[(0,e.jsxs)("div",{className:"flex justify-between flex-row px-1 align-middle day-options text-white relative",children:[(0,e.jsx)("div",{className:"day text-xs",children:w(g(n,i),a)}),(0,e.jsx)("div",{className:"flex gap-1 text-white bg-sky-200/75 px-0.5 rounded-md absolute right-[-8px] top-[-2px]",children:(0,e.jsx)("span",{className:"relative font-normal",children:(0,e.jsx)(Ne,{setRefresh:U,refresh:M,Id:i,startDate:g(n,i),locationId:C,type:"conference"},i)})})]}),(0,e.jsx)("div",{className:"text-white text-left font-normal",children:w(g(n,i),"dd/MM/yyyy")})]})},i));return(0,e.jsx)("div",{className:"days row conference_day",children:o})};var se;let te=a=>{var K;let o=O(d,{weekStartsOn:1}),n=O(g(new Date(o),7),{weekStartsOn:0}),i=[],D=[],v=o,Q="yyyy-MM-dd";for(se=[];v<n;){for(let V=0;V<7;V++){let h=S==null?void 0:S.filter(_=>(_==null?void 0:_.date)===w(new Date(v),Q));D.push((0,e.jsx)("div",{className:`relative col cell border-r  border-b bordersky border-[#C2C2C2] border-collapse ${(h==null?void 0:h.length)>=4?"c-popup-bottom":""}`,children:(0,e.jsxs)(e.Fragment,{children:[!!h&&(0,e.jsx)("div",{children:h==null?void 0:h.map(_=>{var me;return(0,e.jsx)("div",{className:"company_lists",children:(0,e.jsx)(le,{date:v,locationId:C,roomDetail:$,showPlaceHolder:!1,content:_,setRefresh:U,refresh:M,popupView:!1,isAdmin:(me=t==null?void 0:t.currentUser)==null?void 0:me.is_admin})},_==null?void 0:_.id)})}),(0,e.jsx)(le,{date:v,locationId:C,roomDetail:$,showPlaceHolder:!0,content:"",setRefresh:U,refresh:M,popupView:(h==null?void 0:h.length)>=4,isAdmin:(K=t==null?void 0:t.currentUser)==null?void 0:K.is_admin})]})},Math.random())),v=g(v,1)}i.push((0,e.jsx)("div",{className:"row conference",children:D},Math.random())),D=[]}return(0,e.jsx)("div",{className:"row1",children:i},Math.random())};function ae(a){var o;(o=k.current)==null||o.dismiss()}async function re(a){var n,i;B();var o="";o=new Date(a.year,a.month-1,1),((n=new Date(a.year,a.month-1,1))==null?void 0:n.getDay())==0&&(o=new Date(a.year,a.month-1,2)),((i=new Date(a.year,a.month-1,1))==null?void 0:i.getDay())==6&&(o=new Date(a.year,a.month-1,3)),Y(R),u(o),l(I(o)),await L({date:o})}let oe=()=>{var D,v;let a={months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],from:"From",to:"To"};var o="dd";let n=O(d,{weekStartsOn:1},{days:7}),i=`${E==I(new Date)&&(d==null?void 0:d.getFullYear())==((D=new Date)==null?void 0:D.getFullYear())?"This week /":""} ${w(n,o)} th ${a.months[n.getMonth()]} - ${w(g(n,6),o)} th ${a.months[(v=g(n,6))==null?void 0:v.getMonth()]}`;return(0,e.jsxs)("div",{className:"conference",children:[(0,e.jsx)("div",{className:"header row justify-center",children:(0,e.jsxs)("div",{className:"flex flex-col mobile-full",children:[(0,e.jsxs)("div",{className:"flex flex-row custom-date",children:[(0,e.jsxs)("div",{className:"mr-2",children:[a.months[d.getMonth()],","," ",d.getFullYear()]}),(0,e.jsx)("div",{className:"edit cursor-pointer",children:(0,e.jsx)(ke.default,{ref:k,years:{min:{year:new Date().getFullYear()-40},max:{year:new Date().getFullYear()+40}},value:{year:new Date().getFullYear(),month:new Date().getMonth()+1},lang:a.months,onChange:ae,onDismiss:re,children:(0,e.jsx)("i",{onClick:()=>k.current.show(),className:"ri-edit-fill"})})})]}),(0,e.jsxs)("div",{className:"px-3 font-normal text-center text-base week",children:[(0,e.jsx)("span",{className:"font-medium",children:"Conference"})," / Week"," ",E]})]})}),(0,e.jsxs)("div",{className:"header row justify-between",children:[(0,e.jsx)("div",{className:"col",children:(0,e.jsxs)("div",{className:"icon cursor-pointer",onClick:()=>F("prev"),children:[(0,e.jsx)("i",{className:"ri-arrow-left-line ri-1x  "}),(0,e.jsx)("div",{className:"font-nunito font-medium",children:"Previous Week"})]})}),(0,e.jsx)("div",{className:"col col-end flex flex-col justify-between items-end",children:(0,e.jsxs)("div",{className:"icon cursor-pointer",onClick:()=>F("next"),children:[(0,e.jsx)("div",{className:"font-nunito font-medium",children:"Next Week"}),(0,e.jsx)("i",{className:"ri-arrow-right-line ri-1x ml-1 "})]})})]})]})},f=async a=>{var n;await W.users.updateOne((n=t==null?void 0:t.currentUser)==null?void 0:n.id,{selected_locations:{id:a}}).then(i=>{p.success("Updated successfully"),A(!0),setTimeout(()=>{window.location.reload(!0)},1700)}).catch(i=>{p.error("Something went wrong")})},c=()=>{let a=document.getElementById("printContent").innerHTML,o=document.body.innerHTML;document.body.innerHTML=a,window.print(),document.body.innerHTML=o,window.location.reload()},q=a=>{var o;(o=navigator==null?void 0:navigator.clipboard)==null||o.writeText(`${fe}/banner/conference/${C}/screen/${a}`),p.success("Link copied to clipboard!")};return(0,e.jsx)(H.default.Fragment,{children:(J=t==null?void 0:t.currentUser)!=null&&J.conference?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ye,{title:!0,logout:!0,current:t==null?void 0:t.currentUser,location:t==null?void 0:t.currentUser,changeLocation:f,noLeftLogo:!!((x=pe)!=null&&x.includes(C))}),(0,e.jsx)("div",{className:"main-content-area",children:(0,e.jsx)("div",{className:"justify-center items-center px-5 py-4 lg:px-10 p-10 pt-12",children:(0,e.jsxs)("div",{className:"items-right ",children:[(0,e.jsx)("div",{className:"pb-7  items-center lg:px-1",children:oe()}),j?(0,e.jsx)(ge,{}):(0,e.jsxs)(H.default.Fragment,{children:[(0,e.jsx)("div",{className:"calendar rounded-md border-gray-500 border-collapse conference_dashboard",children:(0,e.jsxs)("div",{id:"printContent",children:[ee(),te()]})}),(0,e.jsx)("div",{className:"flex items-center justify-between print-copy",children:(0,e.jsxs)("div",{className:"row-content flex justify-start items-center my-5 flex-wrap gap-5 print-list",children:[(0,e.jsxs)("div",{className:"text-black font-medium text-xs inline-flex",children:[(0,e.jsxs)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",className:"css-i6dzq1",children:[(0,e.jsx)("polyline",{points:"6 9 6 2 18 2 18 9"}),(0,e.jsx)("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),(0,e.jsx)("rect",{x:"6",y:"14",width:"12",height:"8"})]}),(0,e.jsx)("span",{className:"ml-2 cursor-pointer",onClick:()=>c(),children:"PRINT WEEKLY MENU"})]}),((de=t==null?void 0:t.currentUser)==null?void 0:de.is_admin)&&(0,e.jsxs)("div",{className:"text-black font-medium text-xs inline-flex",children:[(0,e.jsx)("i",{className:"ri-file-copy-line"}),(0,e.jsx)("span",{className:"ml-2 cursor-pointer",onClick:()=>q("a"),children:"COPY LINK TO SCREEN A"})]}),((ce=t==null?void 0:t.currentUser)==null?void 0:ce.is_admin)&&(0,e.jsxs)("div",{className:"text-black font-medium text-xs inline-flex",children:[(0,e.jsx)("i",{className:"ri-file-copy-line"}),(0,e.jsx)("span",{className:"ml-2 cursor-pointer",onClick:()=>q("b"),children:"COPY LINK TO SCREEN B"})]})]})})]},Math.random())]})})}),(0,e.jsx)(he,{})]}):(0,e.jsx)(ve,{})},Math.random())}export{Ce as default,Ie as meta};
