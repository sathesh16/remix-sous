{
  "version": 3,
  "sources": ["../../../../app/routes/signup/index.jsx", "../../../../app/components/ImagesUpload.jsx"],
  "sourcesContent": ["import React from 'react'\nimport Input from '../../components/Input'\nimport Button from '../../components/Button'\nimport ImagesUpload from '../../components/ImagesUpload'\nimport { Form, useActionData } from '@remix-run/react'\nimport PasswordInput from '../../components/PasswordInput'\nimport { json, redirect } from '@remix-run/node'\n// import { redirect } from 'next/dist/server/api-utils'\nimport { API_BASE_URL } from '../../utils/constants'\n\nexport async function action({ request }) {\n    const contentType = request.headers.get(\"content-type\");\n    console.log(\"Received Content-Type:\", contentType);\n\n    if (!contentType || !contentType.includes(\"multipart/form-data\")) {\n        return json({ error: \"Bad content-type\", contentType }, { status: 400 });\n    }\n\n    const formData = await request.formData();\n\n    const first_name = formData.get(\"first-name\");\n    const last_name = formData.get(\"last-name\");\n    const email = formData.get(\"email\");\n    const password = formData.get(\"password\");\n    const confirmPassword = formData.get(\"confirm-password\");\n\n    if (password !== confirmPassword) {\n        return json({ error: \"Passwords do not match\" }, { status: 400 });\n    }\n\n    // \uD83D\uDD39 Step 1: Check if email already exists\n    const checkEmailRes = await fetch(\n        `http://192.168.1.51:8056/users?filter[email][_eq]=${encodeURIComponent(email)}`\n    );\n    const checkEmailJson = await checkEmailRes.json();\n\n    if (checkEmailJson?.data?.length > 0) {\n        return json({ error: \"Email already registered\" }, { status: 400 });\n    }\n\n    // \uD83D\uDD39 Step 2: Handle multiple file uploads\n    const images = formData.getAll(\"avatar\"); // multiple files from ImagesUpload\n    let uploadedImageIds = [];\n\n    for (const image of images) {\n        if (image && typeof image !== \"string\" && image.size > 0) {\n            const uploadData = new FormData();\n            uploadData.append(\"file\", image, image.name);\n\n            try {\n                const uploadRes = await fetch(\"http://192.168.1.51:8056/files\", {\n                    method: \"POST\",\n                    body: uploadData,\n                });\n\n                if (!uploadRes.ok) {\n                    console.error(\"File upload failed:\", await uploadRes.text());\n                    continue;\n                }\n\n                const uploadJson = await uploadRes.json();\n                if (uploadJson?.data?.id) uploadedImageIds.push(uploadJson.data.id); //store the id generated by endpoint in array\n            } catch (error) {\n                console.error(\"Error uploading avatar:\", error);\n            }\n        }\n    }\n\n    // \uD83D\uDD39 Step 3: Create user (use the first uploaded image as avatar if any)\n    const avatarId = uploadedImageIds.length > 0 ? uploadedImageIds[0] : null;\n\n    const userRes = await fetch(\"http://192.168.1.51:8056/users\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n            first_name,\n            last_name,\n            email,\n            password,\n            avatar: avatarId,\n            status: \"active\",\n        }),\n    });\n\n    if (!userRes.ok) {\n        const err = await userRes.text();\n        return json({ error: err }, { status: 400 });\n    }\n\n    return redirect(\"/login\");\n}\n\n\nfunction SignUp() {\n\n    const actionData = useActionData()\n\n    return (\n\n        <div className=\"flex flex-col items-center justify-center min-h-screen gap-4 relative p-4\">\n\n            <div className=\"flex items-center justify-between w-full max-w-[400px]\">\n                SignUp\n                <img src=\"/images/iss_logo.webp\" width=\"50px\" />\n            </div>\n\n            {actionData?.error && (\n                <p className=\"text-red-500 text-sm\">{actionData.error}</p>\n            )}\n\n            {actionData?.success && (\n                <p className=\"text-red-500 text-sm\">okay</p>\n            )}\n\n            <Form method=\"post\" encType=\"multipart/form-data\" onSubmit={() => console.log(\"Form submitted\")} className=\"flex flex-col gap-6 max-w-[400px] w-full\">\n\n                <Input type='name' name=\"first-name\" required placeholder=\"Enter your first name\" />\n\n                <Input type='name' name=\"last-name\" required placeholder=\"Enter your last name\" />\n\n                <Input type=\"email\" required name=\"email\" placeholder=\"Email\" />\n\n                <div>Upload your image</div>\n\n                <ImagesUpload name=\"avatar\" />\n\n                <PasswordInput placeholder=\"Enter password\" required name=\"password\" />\n\n                <PasswordInput placeholder=\"Confirm password\" required name=\"confirm-password\" />\n\n                <Button type=\"submit\">\n                    Sign up\n                </Button>\n\n            </Form>\n        </div>\n\n    )\n}\n\nexport default SignUp\n", "import { useState, useEffect } from \"react\";\n\nexport default function ImagesUpload({ name = \"default-name\" }) {\n    const [images, setImages] = useState([]);\n    const [error, setError] = useState(\"\");\n    const [isDragging, setIsDragging] = useState(false);\n\n    const maxSize = 2 * 1024 * 1024; // 2 MB\n\n    // Handle both file input and drag-drop\n    const handleFiles = (files) => {\n        const fileArray = Array.from(files);\n\n        const validFiles = fileArray.filter((file) => {\n            if (file.size > maxSize) {\n                setError(`${file.name} is larger than 2 MB`);\n                return false;\n            }\n            return true;\n        });\n\n        const newImages = validFiles.map((file) => ({\n            file,\n            preview: URL.createObjectURL(file),\n        }));\n\n        setImages((prev) => [...prev, ...newImages]);\n    };\n\n    const handleImageChange = (e) => {\n        handleFiles(e.target.files);\n    };\n\n    const handleDrop = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(false);\n        handleFiles(e.dataTransfer.files);\n    };\n\n    const handleDragOver = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(true);\n    };\n\n    const handleDragLeave = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsDragging(false);\n    };\n\n    useEffect(() => {\n        return () => images.forEach((img) => URL.revokeObjectURL(img.preview));\n    }, [images]);\n\n    return (\n        <div className=\"p-4\">\n            {/* \uD83D\uDD39 Drop Zone */}\n            <div\n                onDrop={handleDrop}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                style={{\n                    padding: \"40px\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    gap: \"20px\",\n                    border: isDragging ? \"2px dashed red\" : \"1px solid #000\",\n                    margin: \"10px auto\",\n                    maxWidth: \"500px\",\n                }}\n            >\n                <p className=\"text-gray-600\">\n                    Drag & Drop your images here or{\" \"}\n                    <label className=\"text-blue-600 cursor-pointer underline\">\n                        click to browse\n                        <input\n                            type=\"file\"\n                            name={name}              // \uD83D\uDC48 dynamic name\n                            multiple\n                            accept=\".jpg, .png\"\n                            onChange={handleImageChange}\n                            className=\"hidden\"\n                        />\n                    </label>\n                </p>\n            </div>\n\n            {/* \uD83D\uDD39 Error Message */}\n            {error && <p className=\"text-red-500 mt-2\">{error}</p>}\n\n            {/* \uD83D\uDD39 Image Previews */}\n            <div style={{ display: \"flex\", gap: \"20px\", flexWrap: \"wrap\" }}>\n                {images.map((img, index) => (\n                    <div\n                        key={index}\n                        className=\"relative\"\n                        style={{ display: \"flex\", gap: \"20px\", flexDirection: \"column\" }}\n                    >\n                        <img\n                            src={img.preview}\n                            alt={`preview ${index}`}\n                            style={{ width: \"100px\", height: \"100px\", objectFit: \"cover\" }}\n                        />\n                        <button\n                            type=\"button\"\n                            onClick={() =>\n                                setImages(images.filter((_, i) => i !== index))\n                            }\n                        >\n                            Remove\n                        </button>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n"],
  "mappings": "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",
  "names": ["import_react", "import_jsx_dev_runtime"]
}
