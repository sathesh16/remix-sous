{
  "version": 3,
  "sources": ["../../../../app/routes/signup/index.jsx", "../../../../app/hooks/useImageUpload.js", "../../../../app/components/ImagesUpload.jsx"],
  "sourcesContent": ["import React from 'react'\nimport Input from '../../components/Input'\nimport Button from '../../components/Button'\nimport ImagesUpload from '../../components/ImagesUpload'\nimport { Form, useActionData } from '@remix-run/react'\nimport PasswordInput from '../../components/PasswordInput'\nimport { json, redirect } from '@remix-run/node'\n// import { redirect } from 'next/dist/server/api-utils'\nimport { API_BASE_URL } from '../../utils/constants'\n\nexport async function action({ request }) {\n    const contentType = request.headers.get(\"content-type\");\n    console.log(\"Received Content-Type:\", contentType);\n\n    if (!contentType || !contentType.includes(\"multipart/form-data\")) {\n        return json({ error: \"Bad content-type\", contentType }, { status: 400 });\n    }\n\n    const formData = await request.formData();\n\n    const first_name = formData.get(\"first-name\");\n    const last_name = formData.get(\"last-name\");\n    const email = formData.get(\"email\");\n    const password = formData.get(\"password\");\n    const confirmPassword = formData.get(\"confirm-password\");\n\n    if (password !== confirmPassword) {\n        return json({ error: \"Passwords do not match\" }, { status: 400 });\n    }\n\n    // \uD83D\uDD39 Step 1: Check if email already exists\n    const checkEmailRes = await fetch(\n        `${API_BASE_URL}/users?filter[email][_eq]=${encodeURIComponent(email)}`\n    );\n    const checkEmailJson = await checkEmailRes.json();\n\n    if (checkEmailJson?.data?.length > 0) {\n        return json({ error: \"Email already registered\" }, { status: 400 });\n    }\n\n    // \uD83D\uDD39 Step 2: Handle multiple file uploads\n    const images = formData.getAll(\"avatar\"); // multiple files from ImagesUpload\n    let uploadedImageIds = [];\n\n    for (const image of images) {\n        if (image && typeof image !== \"string\" && image.size > 0) {\n            const uploadData = new FormData();\n            uploadData.append(\"file\", image, image.name);\n\n            try {\n                const uploadRes = await fetch(`${API_BASE_URL}/files`, {\n                    method: \"POST\",\n                    body: uploadData,\n                });\n\n                if (!uploadRes.ok) {\n                    console.error(\"File upload failed:\", await uploadRes.text());\n                    continue;\n                }\n\n                const uploadJson = await uploadRes.json();\n                if (uploadJson?.data?.id) uploadedImageIds.push(uploadJson.data.id); //store the id generated by endpoint in array\n            } catch (error) {\n                console.error(\"Error uploading avatar:\", error);\n            }\n        }\n    }\n\n    // \uD83D\uDD39 Step 3: Create user (use the first uploaded image as avatar if any)\n    const avatarId = uploadedImageIds.length > 0 ? uploadedImageIds[0] : null;\n\n    const userRes = await fetch(`${API_BASE_URL}/users`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n            first_name,\n            last_name,\n            email,\n            password,\n            avatar: avatarId,\n            status: \"active\",\n        }),\n    });\n\n    if (!userRes.ok) {\n        const err = await userRes.text();\n        return json({ error: err }, { status: 400 });\n    }\n\n    return redirect(\"/login\");\n}\n\n\nfunction SignUp() {\n\n    const actionData = useActionData()\n\n    return (\n\n        <div className=\"flex flex-col items-center justify-center min-h-screen gap-4 relative p-4\">\n\n            <div className=\"flex items-center justify-between w-full max-w-[400px]\">\n                SignUp\n                <img src=\"/images/iss_logo.webp\" width=\"50px\" />\n            </div>\n\n            {actionData?.error && (\n                <p className=\"text-red-500 text-sm\">{actionData.error}</p>\n            )}\n\n            {actionData?.success && (\n                <p className=\"text-red-500 text-sm\">okay</p>\n            )}\n\n            <Form method=\"post\" encType=\"multipart/form-data\" onSubmit={() => console.log(\"Form submitted\")} className=\"flex flex-col gap-6 max-w-[400px] w-full\">\n\n                <Input type='name' name=\"first-name\" required placeholder=\"Enter your first name\" />\n\n                <Input type='name' name=\"last-name\" required placeholder=\"Enter your last name\" />\n\n                <Input type=\"email\" required name=\"email\" placeholder=\"Email\" />\n\n                <div>Upload your image</div>\n\n                <ImagesUpload name=\"avatar\" />\n\n                <PasswordInput placeholder=\"Enter password\" required name=\"password\" />\n\n                <PasswordInput placeholder=\"Confirm password\" required name=\"confirm-password\" />\n\n                <Button type=\"submit\">\n                    Sign up\n                </Button>\n\n            </Form>\n        </div>\n\n    )\n}\n\nexport default SignUp\n", "import { useCallback, useEffect, useState } from \"react\";\n\nconst DEFAULT_MAX_SIZE = 2 * 1024 * 1024; // 2 MB\n\nexport function useImageUpload({ maxSize = DEFAULT_MAX_SIZE } = {}) {\n    const [images, setImages] = useState([]);\n    const [error, setError] = useState(\"\");\n    const [isDragging, setIsDragging] = useState(false);\n\n    const resetError = useCallback(() => setError(\"\"), []);\n\n    const addFiles = useCallback(\n        (fileList) => {\n            if (!fileList || fileList.length === 0) return;\n\n            const files = Array.from(fileList);\n            const validFiles = [];\n            const rejectedMessages = [];\n\n            files.forEach((file) => {\n                if (file.size > maxSize) {\n                    rejectedMessages.push(`${file.name} is larger than ${Math.round(maxSize / (1024 * 1024))} MB`);\n                    return;\n                }\n                validFiles.push({\n                    file,\n                    preview: URL.createObjectURL(file),\n                });\n            });\n\n            if (rejectedMessages.length > 0) {\n                setError(rejectedMessages.join(\"\\n\"));\n            } else {\n                resetError();\n            }\n\n            if (validFiles.length > 0) {\n                setImages((prev) => [...prev, ...validFiles]);\n            }\n        },\n        [maxSize, resetError]\n    );\n\n    const handleInputChange = useCallback(\n        (event) => {\n            addFiles(event.target.files);\n            event.target.value = \"\";\n        },\n        [addFiles]\n    );\n\n    const handleDrop = useCallback(\n        (event) => {\n            event.preventDefault();\n            event.stopPropagation();\n            setIsDragging(false);\n            addFiles(event.dataTransfer.files);\n        },\n        [addFiles]\n    );\n\n    const handleDragOver = useCallback((event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        setIsDragging(true);\n    }, []);\n\n    const handleDragLeave = useCallback((event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        setIsDragging(false);\n    }, []);\n\n    const removeImage = useCallback((index) => {\n        setImages((prev) => {\n            const next = [...prev];\n            const [removed] = next.splice(index, 1);\n            if (removed) {\n                URL.revokeObjectURL(removed.preview);\n            }\n            return next;\n        });\n    }, []);\n\n    useEffect(() => {\n        return () => {\n            images.forEach((img) => URL.revokeObjectURL(img.preview));\n        };\n    }, [images]);\n\n    return {\n        images,\n        error,\n        isDragging,\n        addFiles,\n        handleInputChange,\n        handleDrop,\n        handleDragOver,\n        handleDragLeave,\n        removeImage,\n        resetError,\n    };\n}\n\nexport default useImageUpload;\n\n", "import useImageUpload from \"../hooks/useImageUpload\";\n\nexport default function ImagesUpload({ name = \"default-name\", maxSize }) {\n    const {\n        images,\n        error,\n        isDragging,\n        handleInputChange,\n        handleDrop,\n        handleDragOver,\n        handleDragLeave,\n        removeImage,\n    } = useImageUpload({ maxSize });\n\n    return (\n        <div className=\"p-4\">\n            {/* \uD83D\uDD39 Drop Zone */}\n            <div\n                onDrop={handleDrop}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                style={{\n                    padding: \"40px\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    gap: \"20px\",\n                    border: isDragging ? \"2px dashed red\" : \"1px solid #000\",\n                    margin: \"10px auto\",\n                    maxWidth: \"500px\",\n                }}\n            >\n                <p className=\"text-gray-600\">\n                    Drag & Drop your images here or{\" \"}\n                    <label className=\"text-blue-600 cursor-pointer underline\">\n                        click to browse\n                        <input\n                            type=\"file\"\n                            name={name}              // \uD83D\uDC48 dynamic name\n                            multiple\n                            accept=\".jpg, .png\"\n                            onChange={handleInputChange}\n                            className=\"hidden\"\n                        />\n                    </label>\n                </p>\n            </div>\n\n            {/* \uD83D\uDD39 Error Message */}\n            {error && <p className=\"text-red-500 mt-2\">{error}</p>}\n\n            {/* \uD83D\uDD39 Image Previews */}\n            <div style={{ display: \"flex\", gap: \"20px\", flexWrap: \"wrap\" }}>\n                {images.map((img, index) => (\n                    <div\n                        key={index}\n                        className=\"relative\"\n                        style={{ display: \"flex\", gap: \"20px\", flexDirection: \"column\" }}\n                    >\n                        <img\n                            src={img.preview}\n                            alt={`preview ${index}`}\n                            style={{ width: \"100px\", height: \"100px\", objectFit: \"cover\" }}\n                        />\n                        <button\n                            type=\"button\"\n                            onClick={() => removeImage(index)}\n                        >\n                            Remove\n                        </button>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n"],
  "mappings": "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",
  "names": ["import_react", "import_jsx_dev_runtime"]
}
