{
  "version": 3,
  "sources": ["../../../../../../../app/routes/banner/today-menu/$locationId/$lang/$id.jsx"],
  "sourcesContent": ["import React from \"react\";\nimport { useLoaderData } from \"@remix-run/react\";\nimport { json } from \"@remix-run/node\";\nimport { getDirectusClient } from \"~/lib/directus\";\nimport { DEFAULT_LOCATION_ID } from \"~/utils/constants\";\nimport { sessionStorage } from \"~/services/session.server\";\nimport { format } from \"date-fns\";\nimport Custom404Page from \"~/routes/$\";\nimport LunchContent from \"~/components/banner/lunchContent\";\n\nexport const loader = async ({ request, params }) => {\n  const id = params.id;\n  const lang = params.lang;\n  const dateId = format(new Date(), \"yyyy-MM-dd\");\n  const locationId = params.locationId\n    ? params.locationId\n    : DEFAULT_LOCATION_ID;\n\n  const session = await sessionStorage.getSession(\n    request.headers.get(\"Cookie\")\n  );\n  var sessionKey = session.get(\"sessionKey\");\n  const directus = await getDirectusClient(sessionKey);\n  const Locations = await directus.items(\"Locations\").readByQuery({\n    fields: [\n      \"id\",\n      \"allowed_stations.Locations_id.id\",\n      \"allowed_stations.Stations_id.station_unique_id\",\n      \"*.*.*.*\",\n    ],\n  });\n  const LocationMatch = Locations?.data?.some((e) => e?.id == locationId);\n  // const allowedStationList = Locations?.data?.filter((e) =>\n  //   e?.allowed_stations?.some((e) => e?.Locations_id?.id == locationId)\n  // );\n  const station = Locations?.data?.some((e) =>\n    e?.allowed_stations?.some(\n      (e) =>\n        e?.Locations_id?.id == locationId &&\n        e?.Stations_id?.station_unique_id == id\n    )\n  );\n  const response = await directus.items(\"screen_display\").readByQuery({\n    fields: [\n      \"*.*.\",\n      \"recipe_id.allergens_list.*\",\n      \"recipe_id.allergens_list.Allergens_id.*\",\n      \"recipe_id.dietary_list.*\",\n      \"recipe_id.ingredients_list.new_climate_db.*\",\n      \"recipe_id.dietary_list.Dietary_id.*\",\n      \"station_name.*\",\n      \"station_name.station_image_1.*.*\",\n      \"station_name.station_image_2.*.*\"\n    ],\n    filter: {\n      date: { _eq: dateId },\n      location_id: locationId,\n      station_name: { is_not_main_station: { _eq: false } },\n    },\n    sort: [\"station_name.sequence\"],\n  });\n\n  return json({\n    id,\n    lang,\n    dateId,\n    locationId,\n    LocationMatch,\n    station,\n    Locations,\n    response,\n  });\n};\n\nfunction TodayMenuBanner() {\n  const data = useLoaderData();\n  // const MenuData = data?.response?.data?.filter((e) =>\n  //   filterIds?.includes(Number(e?.station_name?.station_unique_id))\n  // );\n  const MenuData = data?.response?.data?.slice(\n    data?.id === \"1\" ? 0 : (Number(data?.id) - 1) * 5,\n    Number(data?.id) * 5\n  );\n\n  return (\n    <div className=\"page-preview\">\n      {data?.LocationMatch === false ||\n      Number(data?.id) >\n        (data?.response?.data?.length <= 5\n          ? 2\n          : Math.ceil(data?.response?.data?.length / 5)) ||\n      data?.station === false ||\n      (data?.lang !== \"en\" && data?.lang !== \"da\") ? (\n        <Custom404Page />\n      ) : (\n        <LunchContent\n          copyText={\"\"}\n          language={data?.lang}\n          isAdminUser={false}\n          data={MenuData}\n          part={\"\"}\n          LocationId={data?.locationId}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default TodayMenuBanner;\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,mBAAkB;AAKlB,qBAA+B;AAL/B;AA0EA,SAAS,kBAAkB;AA1E3B;AA2EE,QAAM,OAAO,cAAc;AAI3B,QAAM,YAAW,wCAAM,aAAN,mBAAgB,SAAhB,mBAAsB;AAAA,KACrC,6BAAM,QAAO,MAAM,KAAK,OAAO,6BAAM,EAAE,IAAI,KAAK;AAAA,IAChD,OAAO,6BAAM,EAAE,IAAI;AAAA;AAGrB,SACE,mDAAC;AAAA,IAAI,WAAU;AAAA,IACZ,wCAAM,mBAAkB,SACzB,OAAO,6BAAM,EAAE,OACZ,wCAAM,aAAN,mBAAgB,SAAhB,mBAAsB,WAAU,IAC7B,IACA,KAAK,OAAK,wCAAM,aAAN,mBAAgB,SAAhB,mBAAsB,UAAS,CAAC,OAChD,6BAAM,aAAY,UACjB,6BAAM,UAAS,SAAQ,6BAAM,UAAS,OACrC,mDAAC,mBAAD;AAAA;AAAA;AAAA;AAAA,WAAe,IAEf,mDAAC;AAAA,MACC,UAAU;AAAA,MACV,UAAU,6BAAM;AAAA,MAChB,aAAa;AAAA,MACb,MAAM;AAAA,MACN,MAAM;AAAA,MACN,YAAY,6BAAM;AAAA,OANpB;AAAA;AAAA;AAAA;AAAA,WAOA;AAAA,KAjBJ;AAAA;AAAA;AAAA;AAAA,SAmBA;AAEJ;AAEA,IAAO,aAAQ;",
  "names": []
}
