import{a as Q}from"/build/_shared/chunk-QPJOCY54.js";import{b as j}from"/build/_shared/chunk-USL65MEA.js";import{d as A}from"/build/_shared/chunk-RGLHNRFR.js";import"/build/_shared/chunk-7R5B3IJR.js";import"/build/_shared/chunk-VQXNYB6I.js";import{b}from"/build/_shared/chunk-YCQR2KKZ.js";import{A as M,B as _}from"/build/_shared/chunk-74WNBD7U.js";import{a as J}from"/build/_shared/chunk-46CN3765.js";import{b as C,j as I}from"/build/_shared/chunk-62BE6IG2.js";import{a as W,b as L}from"/build/_shared/chunk-TYFUAS6F.js";import{d as v}from"/build/_shared/chunk-W6WK5VNR.js";var o=v(W());var F=v(Q());var Y=v(J());var s=v(L());function O(){var z;let{location_id:P}=I(),E=C(),[h,w]=(0,o.useState)(null),[G,D]=(0,o.useState)(null),[N,n]=(0,o.useState)(null),[R,r]=(0,o.useState)(!1),[y,c]=(0,o.useState)(""),[x,d]=(0,o.useState)([]),S=o.default.useRef(null),T=e=>{e.preventDefault();let i=e.target.files[0],t=new FileReader;t.readAsDataURL(i),t.onloadend=()=>{w(t.result),D(t.result.split(",")[1])}},U=e=>{e.preventDefault()},B=e=>{var l;e.preventDefault();let i=(l=e==null?void 0:e.dataTransfer)==null?void 0:l.files[0],t=new FileReader;i?(t.readAsDataURL(i),t.onload=()=>{var a;w(t.result),D((a=t.result)==null?void 0:a.split(",")[1])}):b.error("Please upload the image again.")},H=e=>{S.current.click()},K=async()=>{r(!0),await fetch(M,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({file_content:G})}).then(e=>e.json()).then(e=>{var i,t,l,a,m,p,u,f,g,k;(i=e==null?void 0:e.output)!=null&&i.is_food?((l=(t=e==null?void 0:e.output)==null?void 0:t.results)==null?void 0:l.length)>=1?(r(!1),n((p=(m=(a=e==null?void 0:e.output)==null?void 0:a.results)==null?void 0:m[0])==null?void 0:p.group),d((g=(f=(u=e==null?void 0:e.output)==null?void 0:u.results)==null?void 0:f[0])==null?void 0:g.items),c("")):(r(!1),n(""),d([]),c("")):(k=e==null?void 0:e.error)!=null&&k.message?(c("Error, please type again: Image size too big. Crop to 544x544 px please"),r(!1),n(""),d([])):(c(""),r(!1),n(""),d([]))}).catch(e=>{c(""),console.log("error",e),n(""),d([]),r(!1),b.error("Something went wrong")})};return(0,s.jsxs)("div",{children:[(0,s.jsx)(A,{title:!0,logout:!0,noLeftLogo:!!((z=_)!=null&&z.includes(P))}),(0,s.jsx)("div",{className:"main-content-area",children:(0,s.jsxs)("div",{className:"page__wrap py-6 max-w-[1440px] px-6 mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-between items-center gap-5",children:(0,s.jsxs)("div",{className:"flex justify-start items-center gap-3",children:[(0,s.jsx)("div",{className:"cursor-pointer text-xl",onClick:()=>E("/"),children:(0,s.jsxs)("span",{children:[(0,s.jsx)("i",{className:"ri-home-4-line"})," /"]})}),(0,s.jsx)("div",{children:(0,s.jsx)("h1",{className:"text-xl font-semibold text-primary",children:"Get Nutrition Results"})})]})}),(0,s.jsx)("div",{className:"py-6 flex flex-col",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-5 overflow-x-auto xl:gap-24",children:[(0,s.jsxs)("div",{className:"col-span-12 md:col-span-6 rounded-sm",children:[(0,s.jsx)("input",{type:"file",accept:"image/jpeg",onChange:T,ref:S,style:{display:"none"}}),(0,s.jsx)("div",{onDragOver:U,onDrop:B,onClick:H,style:{height:"550px",border:"1px dashed #f0f0f0"},children:h?(0,s.jsx)("img",{className:"object-cover",src:h,alt:"uploaded image",style:{width:"100%",height:"100%"}}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"upload-placeholder-section flex items-center justify-center w-full h-full flex-col",children:[(0,s.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"48.000000pt",height:"48.000000pt",viewBox:"0 0 48.000000 48.000000",preserveAspectRatio:"xMidYMid meet",children:(0,s.jsxs)("g",{transform:"translate(0.000000,48.000000) scale(0.100000,-0.100000)",fill:"#000000",stroke:"none",children:[(0,s.jsx)("path",{d:`M77 402 c-14 -16 -17 -43 -17 -164 0 -188 -10 -178 182 -178 188 0
                                                178 -10 178 182 0 188 10 178 -182 178 -128 0 -147 -2 -161 -18z m311 -124 c1
                                                -60 -1 -108 -6 -108 -4 0 -21 14 -37 30 -32 33 -56 38 -75 15 -11 -13 -18 -10
                                                -51 20 -47 42 -64 43 -101 8 l-28 -27 0 80 c0 45 3 84 7 88 4 3 70 5 147 4
                                                l141 -3 3 -107z m-190 -71 l32 -33 -44 -43 c-57 -56 -89 -55 -94 3 -3 32 2 44
                                                29 72 18 19 36 34 39 34 3 0 20 -15 38 -33z m151 -51 c24 -24 40 -49 37 -55
                                                -5 -7 -45 -11 -104 -11 l-96 0 54 55 c30 30 57 55 60 55 3 0 25 -20 49 -44z`}),(0,s.jsx)("path",{d:`M272 338 c-15 -15 -15 -51 0 -66 15 -15 51 -15 66 0 28 28 7 78 -33
                                                78 -12 0 -26 -5 -33 -12z m48 -33 c0 -8 -7 -15 -15 -15 -8 0 -15 7 -15 15 0 8
                                                7 15 15 15 8 0 15 -7 15 -15z`})]})}),(0,s.jsx)("p",{className:"upload-placeholder-text",children:"Drag and drop or click to upload an image"})]})})}),(0,s.jsx)("div",{className:"button-area p-1 mt-6 text-center cursor-pointer",children:(0,s.jsx)("button",{type:"submit",onClick:()=>K(),disabled:!h,style:{opacity:h?1:.5},className:"inline-flex  items-center justify-center h-[40px] text-[18px] rounded border bg-blue-500 border-blue-500 px-4 py-2 text-sm font-bold text-white shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Get Results"})})]}),(0,s.jsx)("div",{className:"col-span-12 md:col-span-6 text-[20px]",children:R||N||y?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"font-medium",children:"Food AI API"}),y?(0,s.jsx)("div",{className:"error-text",children:y}):(0,s.jsx)("div",{className:"mt-5",children:R?(0,s.jsx)("div",{className:"loading-div",children:"Recognizing..."}):(0,s.jsxs)(s.Fragment,{children:[N?(0,s.jsx)("div",{className:"w-full rounded-sm groupName bg-[#ddd]",children:(0,s.jsxs)("div",{className:"bg-[#51d297] text-base font-medium text-black text-left pl-1.5 pr-1 py-1 rounded-sm",style:{width:"80%"},children:[" ",N]})}):null,x?(0,s.jsx)("div",{className:"food-items mt-2 w-full",children:x==null?void 0:x.map((e,i)=>{var t,l,a,m,p,u,f,g;return(0,s.jsxs)("div",{className:"items text-base",children:[(0,s.jsxs)("span",{className:"item-name",children:[e==null?void 0:e.name," "]}),(0,s.jsx)("span",{className:"serving-size font-bold",children:(l=(t=e==null?void 0:e.servingSizes)==null?void 0:t[0])==null?void 0:l.unit}),(0,s.jsx)("span",{className:"calorie-value float-right",children:Math.round((m=(a=e==null?void 0:e.servingSizes)==null?void 0:a[0])!=null&&m.servingWeight?((p=e==null?void 0:e.nutrition)==null?void 0:p.calories)*((f=(u=e==null?void 0:e.servingSizes)==null?void 0:u[0])==null?void 0:f.servingWeight):(g=e==null?void 0:e.nutrition)==null?void 0:g.calories)})]},i)})}):null]})})]}):null})]})})]})}),(0,s.jsx)(j,{})]})}export{O as default};
