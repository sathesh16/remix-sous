import{b as x}from"/build/_shared/chunk-USL65MEA.js";import{d as h}from"/build/_shared/chunk-RGLHNRFR.js";import"/build/_shared/chunk-7R5B3IJR.js";import"/build/_shared/chunk-VQXNYB6I.js";import{b as s}from"/build/_shared/chunk-YCQR2KKZ.js";import{c as f,d as p,g as w,h as y}from"/build/_shared/chunk-74WNBD7U.js";import{e as c,i as m}from"/build/_shared/chunk-62BE6IG2.js";import{a as L,b as u}from"/build/_shared/chunk-TYFUAS6F.js";import{d as l}from"/build/_shared/chunk-W6WK5VNR.js";var n=l(L());var e=l(u());function T(){return{title:"Reset Password"}}function g(){let[i,b]=n.default.useState(""),[v,N]=n.default.useState(!1),[S,r]=n.default.useState(!1),d=y,k=async()=>{r(!0),await d.users.readByQuery({fields:["*"],filter:{email:{_eq:i}}}).then(async o=>{var a,t;return(a=o==null?void 0:o.data[0])!=null&&a.id?await R((t=o==null?void 0:o.data[0])==null?void 0:t.id):s.error("No data found",{onClose:()=>r(!1)})})};async function E({url:o,token:a,name:t,emailTo:_}){var C={to:_,from:w,subject:"Generated new password",name:t,html:`<div>
            <p>Hi<strong> ${t}</strong>,</p>
            <p>Your new password is <strong> ${a}</strong>.</p>
            <p>Click here to  <a href=${f}>login </a></p>
            
            <div>`};return await fetch(o,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(C)}).then(F=>s.success("we sent you a secure password to your mail",{onClose:()=>r(!1)})).catch(F=>s.error("Try again some other time",{onClose:()=>r(!1)})),""}let R=async o=>{let a=Math.random().toString(36).slice(2,7);await d.users.updateOne(o,{password:a,password_token:a,password_copy:a}).then(async t=>(N(!0),await E({url:p,token:t==null?void 0:t.password_token,name:t==null?void 0:t.first_name,emailTo:t==null?void 0:t.email}),t)).catch(t=>{console.log(t),s.error("Something went wrong",{onClose:()=>r(!1)})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(h,{login:!0}),(0,e.jsx)("div",{className:"main-content-area",children:(0,e.jsx)("div",{className:"flex justify-center h-[calc(100vh-75px)] w-full items-center px-5",children:(0,e.jsxs)(m,{className:"max-w-[400px] w-full flex flex-col items-center text-[14px] ",onSubmit:o=>k(o),children:[(0,e.jsx)("h1",{className:"text-center text-[24px] font-bold text-black mb-16",children:"RESET PASSWORD"}),(0,e.jsxs)("div",{className:"mb-6 w-full",children:[(0,e.jsx)("label",{htmlFor:"u-mail-id1",className:"block text-sm font-bold text-gray-700",children:"Email"}),(0,e.jsx)("input",{type:"email",id:"u-mail-id1",placeholder:"Your@email.dk",value:i,onChange:o=>b(o.target.value),required:!0,className:"mt-2 w-full px-4 py-3 flex justify-center items-center shadow-sm border border-primary focus:border-primary placeholder:font-bold placeholder:text-[#6E7878] placeholder:text-[14px] focus:outline-none focus:ring-1 focus:ring-gray-600 sm:text-sm"})]}),v?(0,e.jsx)("div",{className:"mb-8  border-l-lime-500 ... bg-green-100 px-3 py-3 rounded-md",children:"If you have an account, we've sent you a secure link to reset your password"}):null,(0,e.jsxs)("div",{className:"inline-flex w-full flex-row justify-between",children:[(0,e.jsx)("div",{className:"",children:(0,e.jsx)("button",{type:"submit",disabled:S,className:"inline-flex  items-center justify-center h-[50px] text-[18px] rounded border bg-primary border-primary px-4 py-2 text-sm font-bold text-white shadow-sm hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:"Reset"})}),(0,e.jsx)("div",{className:" self-center",children:(0,e.jsx)(c,{to:"/login",children:"Sign In"})})]})]})})}),(0,e.jsx)(x,{login:!0})]})}export{g as default,T as meta};
